<!-- src/app/layout/header/header.component.html -->
<header>
  <nav class="navbar">
    <div class="container navbar-content">
      <a routerLink="/" class="logo">fibiyo</a>

      <div class="search-bar">
        <input type="text" placeholder="Ürün, kategori ya da marka ara" #searchInput (keyup.enter)="onSearch(searchInput.value)">
        <button class="search-button" (click)="onSearch(searchInput.value)">
          <!-- Arama ikonu (SVG veya font icon) eklenebilir -->
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18px" height="18px"><path d="M0 0h24v24H0z" fill="none"/><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
        </button>
      </div>

      <div class="actions">
        <a routerLink="/cart" class="action-link cart-action" *ngIf="isAuthenticated()">
          <!-- Sepet ikonu -->
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24px" height="24px"><path d="M0 0h24v24H0z" fill="none"/><path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zm10 0c-1.1 0-1.99.9-1.99 2S15.9 22 17 22s2-.9 2-2-.9-2-2-2zm-1.45-5c.59 0 1.08-.36 1.32-.88L21.71 4H7.21l-.94-2H3.01v2h2.1l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h10v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45zM6 4.05V4h1.71l.97 2.05H18.3l-3.28 6.39H8.53L6 4.05z"/></svg>
          <span *ngIf="totalCartItems() > 0" class="cart-badge">{{ totalCartItems() }}</span>
        </a>

        <ng-container *ngIf="isAuthenticated(); else guestView">
          <div class="user-menu">
            <a (click)="toggleUserDropdown(); $event.stopPropagation()" class="action-link profile-action" role="button" aria-haspopup="true" [attr.aria-expanded]="isUserDropdownOpen()">
              <!-- Profil ikonu -->
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24px" height="24px"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
              <span>{{ currentUser()?.username }}</span>
              <!-- Açılır ok ikonu eklenebilir -->
              <svg class="dropdown-arrow" *ngIf="!isUserDropdownOpen()" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18px" height="18px"><path d="M7 10l5 5 5-5z"/><path d="M0 0h24v24H0z" fill="none"/></svg>
              <svg class="dropdown-arrow" *ngIf="isUserDropdownOpen()" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18px" height="18px"><path d="M7 14l5-5 5 5z"/><path d="M0 0h24v24H0z" fill="none"/></svg>
            </a>
            <ul class="dropdown-menu" [class.open]="isUserDropdownOpen()">
              <li><a routerLink="/profile" (click)="isUserDropdownOpen.set(false)">Profile</a></li>
              <li><a routerLink="/profile/orders" (click)="isUserDropdownOpen.set(false)">My Orders</a></li>
              <li *ngIf="isAdmin()"><a routerLink="/admin" (click)="isUserDropdownOpen.set(false)">Admin Panel</a></li>
              <li *ngIf="isSeller()"><a routerLink="/seller" (click)="isUserDropdownOpen.set(false)">Seller Panel</a></li>
              <li><hr class="dropdown-divider"></li>
              <li><a (click)="logout(); isUserDropdownOpen.set(false)" class="logout-link">Logout</a></li>
            </ul>
          </div>
        </ng-container>
        <ng-template #guestView>
          <a routerLink="/auth/login" class="btn btn-secondary">Login</a>
          <a routerLink="/auth/register" class="btn btn-primary">Register</a>
        </ng-template>
        <button class="hamburger-menu" (click)="toggleMobileMenu()" [attr.aria-expanded]="isMobileMenuOpen()" aria-controls="mobileNavMenu">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="28px" height="28px"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
        </button>
      </div>
    </div>
  </nav>

  <!-- Mobil Navigasyon Menüsü -->
  <div class="mobile-nav-menu" [class.open]="isMobileMenuOpen()" id="mobileNavMenu">
    <div class="mobile-menu-header">
      <span class="mobile-menu-title">Menu</span>
      <button class="close-mobile-menu" (click)="closeMobileMenu()">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24px" height="24px"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
      </button>
    </div>
    <ul class="mobile-nav-links">
      <li><a routerLink="/" (click)="closeMobileMenu()">Home</a></li>
      <li><a routerLink="/products" (click)="closeMobileMenu()">Products</a></li>
      <ng-container *ngIf="isAuthenticated()">
        <li><a routerLink="/profile" (click)="closeMobileMenu()">Profile</a></li>
        <li><a routerLink="/profile/orders" (click)="closeMobileMenu()">My Orders</a></li>
        <li *ngIf="isAdmin()"><a routerLink="/admin" (click)="closeMobileMenu()">Admin Panel</a></li>
        <li *ngIf="isSeller()"><a routerLink="/seller" (click)="closeMobileMenu()">Seller Panel</a></li>
        <li><a routerLink="/cart" (click)="closeMobileMenu()">Cart <span *ngIf="totalCartItems() > 0">({{ totalCartItems() }})</span></a></li>
        <li><a (click)="logout(); closeMobileMenu()" class="logout-link">Logout</a></li>
      </ng-container>
      <ng-container *ngIf="!isAuthenticated()">
        <li><a routerLink="/auth/login" (click)="closeMobileMenu()">Login</a></li>
        <li><a routerLink="/auth/register" (click)="closeMobileMenu()">Register</a></li>
      </ng-container>
      <!-- Kategori linkleri de buraya eklenebilir -->
    </ul>
  </div>
  <div class="mobile-menu-overlay" [class.open]="isMobileMenuOpen()" (click)="closeMobileMenu()"></div>

  <!-- Kategori Navigasyon Barı -->
  <nav class="category-navbar" *ngIf="categories().length > 0">
    <div class="container category-navbar-content">
      <ul>
        <li *ngFor="let category of categories()">
          <a [routerLink]="['/products']" [queryParams]="{ category: category.slug }">
            {{ category.name }}
          </a>
        </li>
        <!-- Opsiyonel: Daha fazla kategori varsa "Tüm Kategoriler" linki -->
        <!-- <li><a routerLink="/categories">Tüm Kategoriler</a></li> -->
      </ul>
    </div>
  </nav>
</header>
